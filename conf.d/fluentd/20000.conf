<source>
  @type http
  tag fluentd.tag # required
  <parse>
    @type json
  </parse>
  port 20000   # optional. 5170 by default
  bind 0.0.0.0 # optional. 0.0.0.0 by default
</source>

# <match fluentd.tag>
#   @type stdout
# </match>

<match fluentd.tag>
  @type kafka2
  brokers kafka:9093

  use_event_time true

  @id out_general
  <buffer topic>
    @type file

    flush_interval 1s
    flush_thread_count 8
  </buffer>

  <format>
    @type json
  </format>

  default_topic general-topic

  required_acks -1
  max_send_limit_bytes 10485760
</match>